@model RecipesListViewModel

@{
    ViewData["Title"] = "_RecipesListPartial";
}

@foreach (var recipe in Model.Recipes)
{
    if (recipe.Img != null)
    {
        var tmp = "data:image/jpg;base64," + Convert.ToBase64String(recipe.Img, 0, recipe.Img.Length);
        <img alt="" src="@tmp" style="height:300px;width:300px;" />
    }

    <div>
        <h3>@recipe.Name</h3>
        @recipe.Description
        @foreach (var i in recipe.Ingredients)
        {
            <div>
                @String.Format("{0} : {1}{2}", i.Product.Name, i.Quantity, i.Product.Measure)
            </div>
        }
    </div>
}

@if (Model.PagingInfo.CurrentPage > 1)
{
    <input id="prevPage" type="button" value="Prev" />
}
@if (Model.PagingInfo.CurrentPage < Model.PagingInfo.TotalPages)
{
    <input id="nextPage" type="button" value="Next" />
}

<script>
    $("#nextPage").on("click", function (e) {
        var page = @Model.PagingInfo.CurrentPage + 1;
        var selectedTypeIds = $("#typeDropDown").val();
        var includedCategoryIds = $("#categoryIncludedDropDown").val();
        $("#viewPlaceHolder").load("/Home/Recipes",
            { SelectedTypeIds: selectedTypeIds, IncludedCategoryIds: includedCategoryIds, recipePage: page});
    });

    $("#prevPage").on("click", function (e) {
        var page = @Model.PagingInfo.CurrentPage - 1;
        var selectedTypeIds = $("#typeDropDown").val();
        var includedCategoryIds = $("#categoryIncludedDropDown").val();
        $("#viewPlaceHolder").load("/Home/Recipes",
            { SelectedTypeIds: selectedTypeIds, IncludedCategoryIds: includedCategoryIds, recipePage: page});
    });
</script>

